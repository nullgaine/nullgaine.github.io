<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>襍､縺?楜</title>
    <meta name="contained" content="noindex">
    <style>
        body {
            background-color: black;
            color: #00FF00;
            font-family: monospace;
            overflow: hidden;
        }
        .glitch {
            color: #FF0000;
            animation: glitch 1s infinite alternate;
            white-space: pre-wrap;
        }
        @keyframes glitch {
            0% { text-shadow: 2px 2px red, -2px -2px blue; }
            50% { text-shadow: -2px -2px red, 2px 2px blue; }
            100% { text-shadow: 1px 1px red, -1px -1px blue; }
        }
        #messageBox {
            padding: 20px;
            border: 1px solid #00FF00;
            margin: 20px;
            max-width: 80%;
            transition: border-color 1s ease, color 1s ease; /* アニメーション追加 */
        }
        button {
            background-color: #00FF00;
            color: black;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-family: monospace;
            z-index: 10;
            position: relative;
        }
        button:hover {
            background-color: #008000;
        }
        .no-glitch {
            z-index: 10;
            position: relative;
        }
        .red-mode {
            color: #FF0000;
            border-color: #FF0000;
        }
    </style>
</head>
<body>
    <div id="div1">
        <div id="messageBox">
            <strong class="no-glitch">新しいメッセージが（１）通あります！</strong><br>
            <button type="button" class="no-glitch" onclick="go()"> 確認する </button>
            <div id="innerdiv" style="display:none;">
                ================================================================================================<br>
                2025年2月30日 23:10:51　　　　　　　　　　　　　　　　　　　　　  作成　外峯 零<br>
                ================================================================================================<br>
                荒ら屋暮らしの頃は覚えてるだけ無駄らしい？<br>
                それってさ、ちょっと酷い話だと思わないこと？<br>
                ずっとお世話になった荒ら屋も可哀想だし。<br>
                私に『廃墟の歌姫』という渾名が付いたのも此処のお陰だし。<br>
                この街に来てから偶に訪ねたりするの。<br>
                だって此処は、存在しなくなったモノが集まる街だから。<br>
                市街というか、死骸ね。<br>
                無駄だなんて思いたくないわ。<br>
                <br>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        var time = 12 * 1000;
        var ICU = "赤い眼がみている".split("");
        var counter = 0;
        var flag = 0;
        var content1 = document.getElementById("messageBox").innerHTML;
        var interval;
        var startTime;
        var redPhaseStart = 22 * 1000;
        var endPhaseStart = 45 * 1000;

        document.getElementById("innerdiv").style.display = "none";

        function Random(n) {
            return Math.floor(Math.random() * n);
        }

        function Change(str) {
            try {
                var content = str.split("");
                for (var i = 0; i < 10; i++) {
                    var cache = Random(content.length);
                    content[cache] = ICU[Random(ICU.length)];
                }
                document.getElementById("innerdiv").innerHTML = content.join("");  // 変更された内容はinnerdivに表示
            } catch (err) {
                EndMessage();
            }
        }

        function go() {
            // ボタンと最初のメッセージが消えないようにする
            document.getElementById("innerdiv").style.display = "block";
            startTime = new Date().getTime();
            interval = setInterval(Update, 50);
            // ボタンが再度出ないように、go()を一度だけ呼び出す
            document.querySelector("button").disabled = true;
        }

        function Update() {
            var now = new Date().getTime();
            var elapsed = now - startTime;

            // 赤色変化のタイミング調整
            if (elapsed >= redPhaseStart && elapsed < endPhaseStart) {
                document.body.style.color = "#FF0000";
                document.querySelector("button").classList.add("red");
                document.getElementById("messageBox").style.borderColor = "#FF0000";  // 枠の色も変更
                document.getElementById("innerdiv").innerHTML = "<div class='glitch'>赤い眼がみている</div>";  // ここで表示
                return;
            }

            // メッセージを消すタイミング調整
            if (elapsed >= endPhaseStart) {
                EndMessage();
                return;
            }

            if (elapsed >= time) {
                Change(content1); // innerdiv のみに変更を適用
            }
        }

        function EndMessage() {
            clearInterval(interval);
            // 1秒後にメッセージを表示
            setTimeout(function() {
                document.body.innerHTML = '<div class="glitch">よっぽど憶えられたいらしい、随分と変わったお方だこと。<br>良いでしょう、おぼえておくね。</div>';
            }, 1000);  // タイミングをずらす
        }
    </script>

</body>
</html>
